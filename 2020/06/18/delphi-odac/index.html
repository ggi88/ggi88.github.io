<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="Blog">
  <meta name="keyword" content="hexo-theme, vuejs">
  <link rel="canonical" href="http://yoursite.com/2020/06/18/delphi-odac/"/>
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      [delphi] ODAC | 
    
  </title>
  <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.js"></script>
  
  
  
  


  
    <!-- Google Analytics -->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-116608951-1', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End Google Analytics -->
    
</head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>

  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span></span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/categories/" class="item-link">Categorys</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/categories/" class="menu-link">Categorys</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
  </div>
</header>

    <div id="article-banner">
  <h2>[delphi] ODAC</h2>
  <p class="post-date">2020-06-18</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><h2 id="ODAC"><a href="#ODAC" class="headerlink" title="ODAC"></a>ODAC</h2><p>Oracle Data Access Components (ODAC) 라이브러리는 Borland Delphi, C++ Builder and Kylix를 위해 약간의 비시각적 컴포넌트들을 제공합니다. Oracle RDBMS를 엑세스하기위해 제공됩니다. ODAC는 Borland Database Engine(BDE)에서 일반적으로 처리할 데이터 방법을 선택할 수 있습니다.</p>
<p>ODAC는 Oracle Call Interface (OCI)를 직접 사용합니다. Oracle Call 인터페이스는 application programming interface (API)입니다.Application programming interface(API)인 Oracle Call Interface는 3세대 언어의 원시 프로시져를 어플리케이션 개발자들이 사용하도록 도와줍니다. 그리고 Oracle 데이터베이스에 접근하기 위해 함수를 호출하고 SQL문을 실행의 모든 상태를 컨트롤 합니다.OCI는 보편적인 데이터베이스 라이브러리의 접근을 제공하며 동적 런타임 라이브러리의 폼안에서 복구 함수를 제공합니다.</p>
<p>ORA*.DLL는 어플리케이션안에서 링크할 수 있습니다.<br>또한 ODAC의 Net 옵션에서 Oracle 클라이언트 소프트웨어를 설치하지 않고 ODAC에 접속할 수 이도록 허용합니다. 작은 데이터베이스 어플리케이션을 실질적으로 만들기위해 ODAC는 단지 TCP/IP 프로토콜만을 필요로 합니다.</p>
<p>Oracle 지원 클라이언트/서버 어플리케이션 안에 있는 BDE의 사용은 약간의 결함을 가지고 있습니다.<br>BDE 커뮤니티의 결과에 따르면 서버의 특정기능을 사용할 수 없으며, 더많은 리소스를 사용하고, 데이터 처리의 속도를 저하시키며, 어플리케이션 배포를 방해합니다.</p>
<h3 id="컴포넌트"><a href="#컴포넌트" class="headerlink" title="컴포넌트"></a>컴포넌트</h3><p>ODAC는 다음의 컴포넌트들을 포함합니다.</p>
<p>TOraSession - 서버 커넥션을 제어</p>
<p>TOraQuery - 쿼리실행, 레코드셋 사용, 데이터베이스 테이블들의 유연성있는 업데이트</p>
<p>TSmartQuery - 쉬운 사용과 TOraQuery사용, INSERT, DELETE, UPDATE 쿼리 자동생성, 자동 잠금과 레코드 리프레싱</p>
<p>TOraSQL - SQL문 실행, PL/SQL 블록, 저장 프로시져</p>
<p>TOraTable - SQL문을 작성하지 않고 데이터 싱글 테이블의 업데이트 및 가져오기</p>
<p>TOraStoredProc - 저장 프로시져 와 함수의 실행, 파라미터로 되돌아온 커서 데이터를 수정허용</p>
<p>TOraNestedTable - nested 테이블의 데이터 제어</p>
<p>TOraProvider - 클라이언트 데이터셋으로부터 데이터 제공과 업데이트 적용</p>
<p>TOraScript - SQL과 PL/SQL문의 연속실행</p>
<p>TOraAlerter - 세션을 통해 메시지 전송 허용</p>
<p>TOraLoader - Oracle 데이터베이스에 빠른 데이터 로딩 제공</p>
<p>TOraSQLMonitor - ODAC에 기반한 어플리케이션에서 동적 SQL 실행 모니터링 허용</p>
<p>TOraErrorHandler - 에러메세지 설명</p>
<p>TBDESession - BDE에 기반한 어플리케이션 안에서 ODAC 컴포넌트들을 통합가능</p>
<p>TConnectDialog - 사용자이름,패스워드와 서버이름 입력 제공</p>
<p>TVirtualTable - 메모리안에서 데이터셋에 데이터 저장</p>
<h3 id="활용법"><a href="#활용법" class="headerlink" title="활용법"></a>활용법</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span></span><br><span class="line">  TOdacManager = class</span><br><span class="line">  private</span><br><span class="line">    Fcon: TOraSession;</span><br><span class="line">    FQry: TOraQuery;</span><br><span class="line"></span><br><span class="line">    procedure InitDBConnection();</span><br><span class="line">    procedure DeinitDBConnection();</span><br><span class="line"></span><br><span class="line">  public</span><br><span class="line">    constructor Create;</span><br><span class="line">    destructor Destroy; override;</span><br><span class="line"></span><br><span class="line">    procedure StartTransaction;</span><br><span class="line">    <span class="keyword">function</span> InTransaction: Boolean;</span><br><span class="line"></span><br><span class="line">    procedure Commit;</span><br><span class="line">    procedure Rollback;</span><br><span class="line"></span><br><span class="line">    procedure KeepDBConnection;</span><br><span class="line"></span><br><span class="line">    property Qry: TOraQuery <span class="built_in">read</span> FQry;</span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  procedure TOdacManager.Commit;</span><br><span class="line">  begin</span><br><span class="line">    FCon.Commit;</span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  constructor TOdacManager.Create;</span><br><span class="line">  begin</span><br><span class="line">    InitDBConnection;</span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  procedure TOdacManager.DeinitDBConnection;</span><br><span class="line">  begin</span><br><span class="line">    <span class="keyword">if</span> Assigned(FQry) <span class="keyword">then</span></span><br><span class="line">    begin</span><br><span class="line">      FQry.Close;</span><br><span class="line">      FreeAndNil(FQry);</span><br><span class="line">    end;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> Assigned(FCon) <span class="keyword">then</span></span><br><span class="line">    begin</span><br><span class="line">      FCon.Close;</span><br><span class="line">      FreeAndNil(FCon);</span><br><span class="line">    end;</span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  destructor TOdacManager.Destory;</span><br><span class="line">  begin</span><br><span class="line">    DeinitDBConnection;</span><br><span class="line"></span><br><span class="line">    inherited;</span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  procedure TOdacManager.InitDBConnection;</span><br><span class="line">  var</span><br><span class="line">    sConnectString: String;</span><br><span class="line">  begin</span><br><span class="line">    FCon := TOraSession.Create(nil);</span><br><span class="line">    sConnectString := <span class="string">'Direct=True;Host=10.2.220.43;Service Name=DEVGREEN;User ID=GREEN;Password=1234567890;Login Prompt=False'</span>;</span><br><span class="line">    Fcon.ConnectString = sConnectString;</span><br><span class="line"></span><br><span class="line">    FQry := TOraQuery.Create(nil);</span><br><span class="line">    FQry.Connection = FCon;</span><br><span class="line"></span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  procedure TOdacManager.InTransaction: Boolean;</span><br><span class="line">  begin</span><br><span class="line">    Result := FCon.InTransaction;</span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  procedure TOdacManager.KeepDBConnection;</span><br><span class="line">  begin</span><br><span class="line">    <span class="keyword">if</span> not FCon.connected <span class="keyword">then</span></span><br><span class="line">      FCon.connected := True;</span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  procedure TOdacManager.Rollback;</span><br><span class="line">  begin</span><br><span class="line">    FCon.Rollback;</span><br><span class="line">  end;</span><br><span class="line"></span><br><span class="line">  procedure TOdacManager.StartTransaction;</span><br><span class="line">  begin</span><br><span class="line">    FCon.StartTransaction;</span><br><span class="line">  end;</span><br></pre></td></tr></table></figure>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#delphi" >
    <span class="tag-code">delphi</span>
  </a>

  <a href="/tags#ODAC" >
    <span class="tag-code">ODAC</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2020/03/12/oracle-timestamp/">
        <span class="nav-arrow">← </span>
        
          [oracle] timestamp
        
      </a>
    
    
      <a class="nav-right" href="/2020/07/01/2020-07-01-book-doitclonecoding/">
        
          2020-07-01-book-doitclonecoding
        
        <span class="nav-arrow"> →</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- 打赏 START -->
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    
    <!-- 二维码 END -->
    
      <!-- Disqus START -->
      <div id="disqus_thread"></div>
      <!-- Disqus END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#ODAC"><span class="toc-nav-text">ODAC</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#컴포넌트"><span class="toc-nav-text">컴포넌트</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#활용법"><span class="toc-nav-text">활용법</span></a></li></ol></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://yoursite.com/2020/06/18/delphi-odac/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

    // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', 'http://file.muyutech.com/error-img.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== 'http://file.muyutech.com/error-img.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })
  })();
</script>






  <script>
    var disqus_shortname = 'ggi88';
    
    var disqus_url = 'http://yoursite.com/2020/06/18/delphi-odac/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//go.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>


    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2020 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
    <br>
    Theme by <a href="https://github.com/yanm1ng/hexo-theme-vexo" target="_blank" rel="noopener">Vexo</a>
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>
  </body>
</html>